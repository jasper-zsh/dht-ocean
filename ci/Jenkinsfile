pipeline {
  agent any

  stages {
    stage("last-changes") {
      steps {
        script {
          def publisher = LastChanges.getLastChangesPublisher "LAST_SUCCESSFUL_BUILD", "SIDE", "LINE", true, true, "", "", "", "", ""
          publisher.publishLastChanges()
          def changes = publisher.getLastChanges()
          c = changes.getEscapedDiff()
          def pattern = /^diff --([\w]+) a\/(.*?) b\/(.*?)$/
          m = c =~ pattern
          (0..<m.count).each {
            println m[it][0]
          }
        }
      }
    }
  }
}